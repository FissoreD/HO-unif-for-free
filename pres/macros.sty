\usepackage[textsize=tiny]{todonotes}
\setlength{\marginparwidth}{2cm}

\usepackage[newfloat,outputdir=.aux]{minted}

\@ifpackageloaded{hyperref}{}{\usepackage{hyperref}} % ifpackageloaded to avoid issues in beamer

\hypersetup{colorlinks,citecolor=red,linkcolor=blue!60!green,urlcolor=blue}

\usepackage{xspace}
\usepackage[]{biblatex}
\usepackage[]{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{cleveref}
\usepackage{subcaption}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \theoremstyle{definition}
% \newtheorem{example}{Example}
% \newtheorem{theorem}{Theorem}
\ifcsmacro{definition}{}{
  \let\enddefinition\undefined%
  \newtheorem{definition}{Definition}[section]
}

% \newtheorem{notation}{Notation}
% \newtheorem{lemma}{Lemma}

% \theoremstyle{remark}
% \newtheorem*{remark}{Remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INLINE COMMANDS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\elpiIn}[1]{\mintinline[fontsize=\small,escapeinside=~~]{elpi.py:ElpiLexer -x}{#1}}
\newcommand{\elpiInFN}[1]{\mintinline[fontsize=\footnotesize,escapeinside=~~]{elpi.py:ElpiLexer -x}{#1}}
\newcommand{\coqIn}[1]{\mintinline[fontsize=\small,escapeinside=~~]{coq}{#1}}
\newcommand{\textIn}[1]{\mintinline[escapeinside=~~]{text}{#1}}

\newcommand{\elpiInEq}[2][]{
  \begin{equation}
    \texttt{\elpiIn{#2}}
    \label{#1}
  \end{equation}
}

\newcommand{\elpiInEqq}[2][]{
  \begin{equation*}
    \texttt{\elpiIn{#2}}
    \label{#1}
  \end{equation*}
}

\newcommand{\coqInEq}[2][]{
  \begin{equation}
    \texttt{\coqIn{#2}}
    \label{#1}
  \end{equation}
}

\newenvironment{coqcode}{%
  \vspace{0.2em}%
  \VerbatimEnvironment
  \begin{minted}[fontsize=\small,autogobble,escapeinside=~~,mathescape=true,frame=leftline,framerule=0pt,framesep=1em]{coq}%
}{%
  \end{minted}%
  \vspace{0.2em}%
}

\newenvironment{elpicode}{%
  \vspace{0.2em}%
  \VerbatimEnvironment
  \begin{minted}[fontsize=\small,autogobble,escapeinside=~~,mathescape=true,frame=leftline,framerule=0pt,framesep=1em]{\elpiLexer}%
}{%
  \end{minted}%
  \vspace{0.2em}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% OTHER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand*{\eqdef}{\ensuremath{\mathrel{\overset{\mathrm{def}}{=}}}}

\newcommand{\mysep}{\begin{center}\line(1,0){40}\end{center}}

\newcommand{\elpiLexer}{elpi.py:ElpiLexer -x}

\newcommand{\maybebeta}{\ensuremath{\diamond\beta}}
\newcommand{\maybeeta}{\ensuremath{\diamond\eta}}
\newcommand{\maybelam}{\ensuremath{\diamond\mathcal{L}}}
%

\newcommand{\EqualRel}{\ensuremath{=}}
\newcommand{\nEqualRel}{\ensuremath{\new}}
\newcommand{\UnifRel}{\ensuremath{\simeq}}
\newcommand{\nUnifRel}{\ensuremath{\not\simeq}}
\newcommand{\Uo}{\texorpdfstring{\ensuremath{\UnifRel_o}\xspace}{unif\_o}}
\newcommand{\nUo}{\ensuremath{\nUnifRel_o}\xspace}
\newcommand{\Eo}{\ensuremath{\EqualRel_o}\xspace}
\newcommand{\nEo}{\ensuremath{\nEqualRel_o}\xspace}

\newcommand{\Ue}{\ensuremath{\UnifRel_m}\xspace}
\newcommand{\nUe}{\ensuremath{\nUnifRel_m}\xspace}
\newcommand{\Ee}{\ensuremath{\EqualRel_m}\xspace}
\newcommand{\nEe}{\ensuremath{\nEqualRel_m}\xspace}
\newcommand{\mapStore}{\texorpdfstring{\ensuremath{\mathbb{M}}\xspace}{M}}
\newcommand{\foUnifPb}{\ensuremath{\mathbb{P}}\xspace}
\newcommand{\hoUnifPb}{\ensuremath{\mathbb{Q}}\xspace}
\newcommand{\C}[4]{\ensuremath{\langle #1 \rangle}\mapsto(#2,#3,#4)}
\newcommand{\D}[4]{\ensuremath{\langle #1,#2,#3 \rangle^{-1}\mapsto #4}}
\newcommand{\progress}{\ensuremath{\mathrm{progress}}\xspace}
\newcommand{\fstep}{\ensuremath{{\mathrm{step}}_o}\xspace}
\newcommand{\hstep}{\ensuremath{{\mathrm{step}}_m}\xspace}
\newcommand{\frun}{\ensuremath{{\mathrm{run}}_o}\xspace}
\newcommand{\hrun}{\ensuremath{{\mathrm{run}}_m}\xspace}
\newcommand{\stepF}[4]{\ensuremath{\fstep(#1,#2,#3) \mapsto #4}}
\newcommand{\stepFD}[4]{%
  \ensuremath{#3 #1_{#2_l} \Uo #3 #1_{#2_r} \mapsto #4}}
\newcommand{\stepH}[6]{\ensuremath{\hstep(#1,#2,#3,#4) \mapsto (#5, #6)}}
\newcommand{\stepHD}[6]{\ensuremath{%
    #3 #1_{#2_l} \Ue #3 #1_{#2_r} \mapsto #4 \land \progress(#6,#4) \mapsto (#6',#5)}}
\newcommand{\runF}[3]{\ensuremath{\frun(#1,#2) \mapsto #3_{#2}}}
\newcommand{\runFx}[3]{\ensuremath{\frun(#1,#2) \mapsto #3}}
\newcommand{\runFD}[2]{\ensuremath{%
    \bigwedge_{p = 1}^{#2} \stepF{#1}{p}{\rho_{p-1}}{\rho_{p}}}}
\newcommand{\runH}[3]{\ensuremath{\hrun(#1,#2) \mapsto #3_{#2}}}
\newcommand{\runHx}[3]{\ensuremath{\hrun(#1,#2) \mapsto #3}}
\newcommand{\runHD}[3]{\ensuremath{%
    \bigwedge_{p = 1}^{#2} \stepH{#1}{p}{\sigma_{p-1}}{#3_{p-1}}{\sigma_{p}}{#3_p}}}
\newcommand{\deff}{\ensuremath{\stackrel{{\scriptscriptstyle def}}{=\!=\!\!\!=}}}
\newcommand{\llambda}{\ensuremath{\mathcal{L}}\xspace}
\newcommand{\linkMacro}[1]{\ensuremath{#1}\texttt{-link}\xspace}
\newcommand{\linkStore}{\texorpdfstring{\ensuremath{\mathbb{L}}\xspace}{L}}
\newcommand{\appsep}{\ensuremath{\textcolor{lightgray}{\cdot}}}
